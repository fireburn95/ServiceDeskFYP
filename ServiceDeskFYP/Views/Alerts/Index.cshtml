@model ServiceDeskFYP.Models.ViewAlertsPageViewModel

@{
    ViewBag.Title = "Index";
}

<h2>Alerts</h2>

<!--HANDLE ERRORS-->
@if (ViewBag.ErrorMessage != null)
{
    <h5 style="color:red">@ViewBag.ErrorMessage</h5>
}
@if (ViewBag.SuccessMessage != null)
{
    <h5 style="color:blue">@ViewBag.SuccessMessage</h5>
}

<!--DISPLAY STATISTICS-->
@if (Model.ExceededSLACalls != 0)
{
    <p class="alert-danger">You have @Model.ExceededSLACalls Calls past SLA</p>
}
@if (Model.PastRequiredDate != 0)
{
    <p class="alert-danger">You have @Model.PastRequiredDate Calls which have exceeded their required-date</p>
}



<!--END OF DISPLAY STATISTICS-->


@foreach (var item in Model.Alerts)
{
    <p>
        @if (item.FromUserId != null && item.FromGroupId != null)
        {
            <text>From: @item.FromUserName via @item.FromGroupName</text> <br />
        }
        else if (item.FromUserId != null)
        {
            <text>From: @item.FromUserName</text> <br />
        }
        else if (item.FromGroupId != null)
        {
            <text>From: @item.FromGroupName</text> <br />
        }
        @item.Text
        <br />
        @if (item.AssociatedCallRef != null)
        {
            @Html.ActionLink("Go to", "ViewCall", "Desk", new { Reference = item.AssociatedCallRef }, null)
        }
        @if (item.AssociatedKnowledgeId != null)
        {
            @Html.ActionLink("Go to", "FindKnowledgeURL", "Groups", new { knowledgeid = item.AssociatedKnowledgeId }, null)
        }
        @if (item.FromUserId != null && item.Dismissed == false)
        {
            @Html.ActionLink("Reply", "ReplyToAlertGET", new { alertid = item.Id }, null)
        }
        @if (item.Dismissed == false)
        {
            <text>Dismiss</text>
        }
        else
        {
            <text>Restate</text>
        }
    </p>
}